name: GitHub Actions Demo
on: [push]
jobs:
  build-and-run-prog:
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]
    runs-on: ${{ matrix.os }}
    steps:
      - uses: actions/checkout@v2
      - name: Set environment variables
        run: |
          echo FLAGS=-O2 >> $GITHUB_ENV
      - name: Compile and run prog (non-windows)
        run: |
          gcc prog.c -o prog $FLAGS
          ./prog
        if: ${{ matrix.os != 'windows-latest' }}
      - name: Compile and run prog (windows)
        run: |
          gcc prog.c -o prog $FLAGS
          .\prog
        if: ${{ matrix.os == 'windows-latest' }}
